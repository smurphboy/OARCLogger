{% extends 'base.html' %}
{% block scripts %}
<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
{% endblock %}
{% block hero %}is-primary{% endblock %}
{% block content %}
    <div class="bd-hero-heading">
        <h1 class="title is-size-1">
            {% block title %} <p>Add a New QSO for {{ station_callsign }}</p> {% endblock %}
        </h1>
        <div class="subtitle is-4 algolia-lvl1">
            <p>Enter QSO details below and press Add:</p>     
        </div>
    </div>
</section>
<section class="section">
    <div class="container">
        {% with messages = get_flashed_messages() %}
        {% if messages %}
        <div class="box notification">
            <div class="notification is-info">
                {% for message in messages%}
                {{ message }}
                {% endfor %}
            </div>
        </div>
        {% endif %}
        {% endwith %}
        <div class="box">
            <h1 class="title"><a href="{{ url_for('events.eventlist', username=current_user.name) }}">Selected Events</a></h1>
            <nav class="level">
                <div class="level-left">
                    {% for event in current_user.selected_events %}
                    <div class="level-item">
                        <div class="control">
                            <div class="tags has-addons">
                                <a class="tag is-primary" href="{{ url_for ('events.eventview', id=event.id) }}" >{{ event.name }}</a>
                                <span class="tag is-info is-light">{{ event.type }}</span>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                <div class="level-right">
                    <div class="level-item">
                        <a class="button is-link" href="{{ url_for('events.selectevents', username=current_user.name) }}">Change Selected</a>
                    </div>
                </div>
            </nav>
        </div>
        <form method="POST" id="qsoform">
            {{ form.csrf_token }}
            <div class="card">
                <header class="card-header">
                    <p class="card-header-title">Date & Time - all times UTC</p>
                    <a class="card-header-icon" id="datetime" aria-label="more options">
                        <span class="icon">
                            <i class="fa-solid fa-clock"></i>
                        </span>
                    </a>
                </header>
                <div class="card-content" id="datetime-content">
                    <nav class="level">
                        <div class="level-left">
                            <div class="level-item">
                                <div class="field">
                                    {{ form.qso_date.label(class_="label") }}
                                    <p class="control is-expanded">
                                    {{ form.qso_date(class_="input") }}
                                    </p>
                                </div>
                                {% if form.qso_date.errors %}
                                    <ul class="errors">
                                        {% for error in form.qso_date.errors %}
                                            <li>{{ error }}</li>
                                        {% endfor %}
                                    </ul>
                                {% endif %}
                            </div>
                            <div class="level-item">
                                <div class="field">
                                    {{ form.time_on.label(class_="label") }}
                                    <p class="control is-expanded">
                                    {{ form.time_on(class_="input") }}
                                    </p>
                                </div>
                                {% if form.time_on.errors %}
                                    <ul class="errors">
                                        {% for error in form.time_on.errors %}
                                            <li>{{ error }}</li>
                                        {% endfor %}
                                    </ul>
                                {% endif %}
                            </div>
                        </div>
                        <div class="level-right">
                            <div class="level-item">
                                <div class="field">
                                    {{ form.qso_date_off.label(class_="label") }}
                                    <p class="control is-expanded">
                                    {{ form.qso_date_off(class_="input") }}
                                    </p>
                                </div>
                                {% if form.qso_date_off.errors %}
                                    <ul class="errors">
                                        {% for error in form.qso_date_off.errors %}
                                            <li>{{ error }}</li>
                                        {% endfor %}
                                    </ul>
                                {% endif %}
                            </div>
                            <div class="level-item">
                                <div class="field">
                                    {{ form.time_off.label(class_="label") }}
                                    <p class="control is-expanded">
                                    {{ form.time_off(class_="input") }}
                                    </p>
                                </div>
                                {% if form.time_off.errors %}
                                    <ul class="errors">
                                        {% for error in form.time_off.errors %}
                                            <li>{{ error }}</li>
                                        {% endfor %}
                                    </ul>
                                {% endif %}
                            </div>
                        </div>
                    </nav>
                </div>
                <footer class="card-footer" id="datetime-footer">
                    <a class="card-footer-item" id="qsoon">Set QSO On</a>
                    <a class="card-footer-item" id="qsooff">Set QSO Off</a>
                </footer>
            </div>
            <div class="card">
                <header class="card-header">
                    <p class="card-header-title">Callsigns</p>
                </header>
                <div class="card-content" id="callsigns-content">
                    <nav class="level">
                        <div class="level-left">
                            <div class="level-item">
                                <div class="field">
                                    {{ form.call.label(class_='label') }}
                                    <div class="control">
                                        {{ form.call(class_="input", placeholder_="Called station") }}
                                    </div>
                                </div>
                                {% if form.call.errors %}
                                    <ul class="errors">
                                        {% for error in form.call.errors %}
                                            <li>{{ error }}</li>
                                        {% endfor %}
                                    </ul>
                                {% endif %}
                            </div>
                            <div class="level-item">
                                <div class="field">
                                    {{ form.dxcc.label(class_='label') }}
                                    <div class="control">
                                        {{ form.dxcc(class_="input", placeholder_="DXCC - called station") }}
                                    </div>
                                </div>
                                {% if form.dxcc.errors %}
                                    <ul class="errors">
                                        {% for error in form.dxcc.errors %}
                                            <li>{{ error }}</li>
                                        {% endfor %}
                                    </ul>
                                {% endif %}
                            </div>
                            <div class="level-item">
                                <div class="field">
                                    {{ form.country.label(class_='label') }}
                                    <div class="control">
                                        {{ form.country(class_="input", placeholder_="Country - called station", autocomplete_="country-name") }}
                                    </div>
                                </div>
                                {% if form.country.errors %}
                                    <ul class="errors">
                                        {% for error in form.country.errors %}
                                            <li>{{ error }}</li>
                                        {% endfor %}
                                    </ul>
                                {% endif %}
                            </div>
                            <div class="level-item">
                                <div class="field">
                                    {{ form.cqz.label(class_='label') }}
                                    <div class="control">
                                        {{ form.cqz(class_="input", placeholder_="CQZ - called station") }}
                                    </div>
                                </div>
                                {% if form.cqz.errors %}
                                    <ul class="errors">
                                        {% for error in form.cqz.errors %}
                                            <li>{{ error }}</li>
                                        {% endfor %}
                                    </ul>
                                {% endif %}
                            </div>
                            <div class="level-item">
                                <div class="field">
                                    {{ form.ituz.label(class_='label') }}
                                    <div class="control">
                                        {{ form.ituz(class_="input", placeholder_="ITUZ - called station") }}
                                    </div>
                                </div>
                                {% if form.ituz.errors %}
                                    <ul class="errors">
                                        {% for error in form.ituz.errors %}
                                            <li>{{ error }}</li>
                                        {% endfor %}
                                    </ul>
                                {% endif %}
                            </div>    
                        </div>
                    </nav>
                </div>
                <footer class="card-footer" id="callsigns-footer">
                    <button class="button card-footer-item" id="lookupbutton">Lookup Callsign</button>
                </footer>
            </div>
            <div class="card">
                <header class="card-header">
                    <p class="card-header-title">Modes and Bands</p>
                    <a class="card-header-icon" id="modes_bands" aria-label="more options">
                        <span class="icon">
                            <i class="fa-solid fa-wave-square"></i>
                        </span>
                    </a>
                </header>
                <div class="card-content" id="modes_bands-content">
                    <nav class="level">
                        <div class="level-left">
                            <div class="level-item">
                                <div class="field">
                                    {{ form.mode.label(class_="label") }}
                                    <div class="select">
                                    {{ form.mode() }}
                                    </div>
                                </div>
                                {% if form.mode.errors %}
                                    <ul class="errors">
                                        {% for error in form.mode.errors %}
                                            <li>{{ error }}</li>
                                        {% endfor %}
                                    </ul>
                                {% endif %}
                            </div>
                            <div class="level-item">
                                <div class="field">
                                    {{ form.submode.label(class_='label') }}
                                    <div class="select">
                                        {{ form.submode() }}
                                    </div>
                                </div>
                                {% if form.submode.errors %}
                                    <ul class="errors">
                                        {% for error in form.submode.errors %}
                                            <li>{{ error }}</li>
                                        {% endfor %}
                                    </ul>
                                {% endif %}
                            </div>
                        </div>
                    </nav>
                    <nav class="level">
                        <div class="level-left">
                            <div class="level-item">
                                <div class="field">
                                    {{ form.band.label(class_='label') }}
                                    <div class="select">
                                        {{ form.band() }}
                                    </div>
                                </div>
                                {% if form.band.errors %}
                                    <ul class="errors">
                                        {% for error in form.band.errors %}
                                            <li>{{ error }}</li>
                                        {% endfor %}
                                    </ul>
                                {% endif %}
                            </div>
                            <div class="level-item">
                                <div class="field">
                                    {{ form.freq.label(class_='label') }}
                                    <div class="control">
                                        {{ form.freq(class_="input", placeholder_="Freq in MHz (7.150)") }}
                                    </div>
                                </div>
                                {% if form.freq.errors %}
                                    <ul class="errors">
                                        {% for error in form.freq.errors %}
                                            <li>{{ error }}</li>
                                        {% endfor %}
                                    </ul>
                                {% endif %}
                            </div> 
                        </div>
                    </nav>
                    <nav class="level">
                        <div class="level-left">
                            <div class="level-item">
                                <div class="field">
                                    {{ form.band_rx.label(class_='label') }}
                                    <div class="select">
                                        {{ form.band_rx() }}
                                    </div>
                                </div>
                                {% if form.band_rx.errors %}
                                    <ul class="errors">
                                        {% for error in form.band_rx.errors %}
                                            <li>{{ error }}</li>
                                        {% endfor %}
                                    </ul>
                                {% endif %}
                            </div>
                            <div class="level-item">
                                <div class="field">
                                    {{ form.freq_rx.label(class_='label') }}
                                    <div class="control">
                                        {{ form.freq_rx(class_="input", placeholder_="RX Freq in MHz (7.150)") }}
                                    </div>
                                </div>
                                {% if form.freq_rx.errors %}
                                    <ul class="errors">
                                        {% for error in form.freq_rx.errors %}
                                            <li>{{ error }}</li>
                                        {% endfor %}
                                    </ul>
                                {% endif %}
                            </div>   
                        </div>
                    </nav>
                    <nav class="level">
                        <div class="level-left">
                            <div class="level-item">
                                <div class="field">
                                    {{ form.prop_mode.label(class_="label") }}
                                    <div class="control">
                                    {{ form.prop_mode(class_="input", placeholder_="e.g. Sat or ") }}
                                    </div>
                                    {% if form.prop_mode.errors %}
                                    <ul class="errors">
                                        {% for error in form.prop_mode.errors %}
                                            <li>{{ error }}</li>
                                        {% endfor %}
                                    </ul>
                                    {% endif %}
                            </div>
                        </div>
                    </nav>
                </div>
                <footer class="card-footer" id="modes_bands-footer">
                    <button class="button card-footer-item" id="modes_bandsbutton">Lookup Band from Freq</button>
                </footer>
            </div>
            <div class="card">
                <header class="card-header">
                    <p class="card-header-title">Additional Callsigns</p>
                    <a class="card-header-icon" id="add_callsigns" aria-label="more options">
                        <span class="icon">
                            <i class="fas fa-angle-down" aria-hidden="true"></i>
                        </span>
                    </a>
                </header>
                <div class="card-content is-hidden" id="add_callsigns-content">
                    <nav class="level">
                        <div class="level-left">
                            <div class="level-item">
                                <div class="field">
                                    {{ form.station_callsign.label(class_='label') }}
                                    <div class="control">
                                        {{ form.station_callsign(class_="input", placeholder_="Logged call on the air") }}
                                    </div>
                                </div>
                                {% if form.station_callsign.errors %}
                                    <ul class="errors">
                                        {% for error in form.station_callsign.errors %}
                                            <li>{{ error }}</li>
                                        {% endfor %}
                                    </ul>
                                {% endif %}
                            </div>
                            <div class="level-item">
                                <div class="field">
                                    {{ form.operator.label(class_='label') }}
                                    <div class="control">
                                        {{ form.operator(class_="input", placeholder_="Logging OPs call") }}
                                    </div>
                                </div>
                                {% if form.operator.errors %}
                                    <ul class="errors">
                                        {% for error in form.operator.errors %}
                                            <li>{{ error }}</li>
                                        {% endfor %}
                                    </ul>
                                {% endif %}
                            </div>
                        </div>
                    </nav>
                    <nav class="level">
                        <div class="level-left">
                            <div class="level-item">
                                <div class="field">
                                    {{ form.owner_callsign.label(class_='label') }}
                                    <div class="control">
                                        {{ form.owner_callsign(class_="input", placeholder_="Call of Station Owner") }}
                                    </div>
                                </div>
                                {% if form.owner_callsign.errors %}
                                    <ul class="errors">
                                        {% for error in form.owner_callsign.errors %}
                                            <li>{{ error }}</li>
                                        {% endfor %}
                                    </ul>
                                {% endif %}
                            </div>
                            <div class="level-item">
                                <div class="field">
                                    {{ form.contacted_op.label(class_='label') }}
                                    <div class="control">
                                        {{ form.contacted_op(class_="input", placeholder_="Call of contacted Op") }}
                                    </div>
                                </div>
                                {% if form.contacted_op.errors %}
                                    <ul class="errors">
                                        {% for error in form.contacted_op.errors %}
                                            <li>{{ error }}</li>
                                        {% endfor %}
                                    </ul>
                                {% endif %}
                            </div>
                            <div class="level-item">
                                <div class="field">
                                    {{ form.eq_call.label(class_='label') }}
                                    <div class="control">
                                        {{ form.eq_call(class_="input", placeholder_="Call of owner of contacted station") }}
                                    </div>
                                </div>
                                {% if form.eq_call.errors %}
                                    <ul class="errors">
                                        {% for error in form.eq_call.errors %}
                                            <li>{{ error }}</li>
                                        {% endfor %}
                                    </ul>
                                {% endif %}
                            </div> 
                        </div>
                    </nav>
                </div>
            </div>
            <div class="card">
                <header class="card-header">
                    <p class="card-header-title">Reports & Serials</p>
                    <a class="card-header-icon" id="reports" aria-label="more options">
                        <span class="icon">
                            <i class="fa-solid fa-signal"></i>
                        </span>
                    </a>
                </header>
                <div class="card-content is-hidden" id="reports-content">
                    <nav class="level">
                        <div class="level-left">
                            <div class="level-item">
                                <div class="field">
                                    {{ form.rst_rcvd.label(class_='label') }}
                                    <div class="control">
                                        {{ form.rst_rcvd(class_="input", placeholder_="RST Received") }}
                                    </div>
                                </div>
                                {% if form.rst_rcvd.errors %}
                                    <ul class="errors">
                                        {% for error in form.rst_rcvd.errors %}
                                            <li>{{ error }}</li>
                                        {% endfor %}
                                    </ul>
                                {% endif %}
                            </div>
                            <div class="level-item">
                                <div class="field">
                                    {{ form.rst_sent.label(class_='label') }}
                                    <div class="control">
                                        {{ form.rst_sent(class_="input", placeholder_="RST Sent") }}
                                    </div>
                                </div>
                                {% if form.rst_sent.errors %}
                                    <ul class="errors">
                                        {% for error in form.rst_sent.errors %}
                                            <li>{{ error }}</li>
                                        {% endfor %}
                                    </ul>
                                {% endif %}
                            </div>
                        </div>
                    </nav>
                    <nav class="level">
                        <div class="level-left">
                            <div class="level-item">
                                <div class="field">
                                    {{ form.srx.label(class_='label') }}
                                    <div class="control">
                                        {{ form.srx(class_="input", placeholder_="Serial Received") }}
                                    </div>
                                </div>
                                {% if form.srx.errors %}
                                    <ul class="errors">
                                        {% for error in form.srx.errors %}
                                            <li>{{ error }}</li>
                                        {% endfor %}
                                    </ul>
                                {% endif %}
                            </div>
                            <div class="level-item">
                                <div class="field">
                                    {{ form.stx.label(class_='label') }}
                                    <div class="control">
                                        {{ form.stx(class_="input", placeholder_="Serial Received") }}
                                    </div>
                                </div>
                                {% if form.stx.errors %}
                                    <ul class="errors">
                                        {% for error in form.stx.errors %}
                                            <li>{{ error }}</li>
                                        {% endfor %}
                                    </ul>
                                {% endif %}
                            </div>
                        </div>
                    </nav>
                    <nav class="level">
                        <div class="level-left">
                            <div class="level-item">
                                <div class="field">
                                    {{ form.srx_string.label(class_='label') }}
                                    <div class="control">
                                        {{ form.srx_string(class_="input", placeholder_="Serial String Received") }}
                                    </div>
                                </div>
                                {% if form.srx_string.errors %}
                                    <ul class="errors">
                                        {% for error in form.srx_string.errors %}
                                            <li>{{ error }}</li>
                                        {% endfor %}
                                    </ul>
                                {% endif %}
                            </div> 
                            <div class="level-item">
                                <div class="field">
                                    {{ form.stx_string.label(class_='label') }}
                                    <div class="control">
                                        {{ form.stx_string(class_="input", placeholder_="Serial String Sent") }}
                                    </div>
                                </div>
                                {% if form.stx_string.errors %}
                                    <ul class="errors">
                                        {% for error in form.stx_string.errors %}
                                            <li>{{ error }}</li>
                                        {% endfor %}
                                    </ul>
                                {% endif %}
                            </div> 
                        </div>
                    </nav>
                </div>
            </div>
            <div class="card">
                <header class="card-header">
                    <p class="card-header-title is-info">Locations</p>
                    <a class="card-header-icon" id="locations" aria-label="more options">
                        <span class="icon">
                            <i class="fa-solid fa-location-dot" aria-hidden="true"></i>
                        </span>
                    </a>
                </header>
                <div class="card-content is-hidden" id="locations-content">
                    <div class="field is-horizontal">
                        <div class="field-label is-normal">
                            {{ form.my_gridsquare.label(class_="label") }}
                        </div>
                        <div class="field-body">
                            <div class="field has-addons">
                                <div class="control">
                                {{ form.my_gridsquare(class_="input", placeholder_="My Maidenhead Grid Square") }}
                                </div>
                                <div class="control">
                                    <a class="button is-info" id="mymaiden2latlon">&gt; Lat/Long</a>
                                </div>
                            </div>
                        {% if form.my_gridsquare.errors %}
                            <ul class="errors">
                                {% for error in form.my_gridsquare.errors %}
                                    <li>{{ error }}</li>
                                {% endfor %}
                            </ul>
                        {% endif %}
                        </div>
                    </div>
                    <div class="field is-horizontal">
                        <div class="field-label is-normal">
                            <label class="label" for="my_lat">My Lat / Long</label>
                        </div>
                        <div class="field-body">
                            <div class="field">
                                <div class="control">
                                {{ form.my_lat(class_="input", placeholder_="My latitude") }}
                                </div>
                            </div>
                            {% if form.my_lat.errors %}
                            <ul class="errors">
                                {% for error in form.my_lat.errors %}
                                    <li>{{ error }}</li>
                                {% endfor %}
                            </ul>
                            {% endif %}
                            <div class="field">
                                <div class="control">
                                {{ form.my_lon(class_="input", placeholder_="My longitude") }}
                                </div>
                            </div>
                            {% if form.my_lon.errors %}
                            <ul class="errors">
                                {% for error in form.my_lon.errors %}
                                    <li>{{ error }}</li>
                                {% endfor %}
                            </ul>
                            {% endif %}
                        </div>
                    </div>
                    <div class="field is-horizontal">
                        <div class="field-label is-normal">
                            {{ form.gridsquare.label(class_="label") }}
                        </div>
                        <div class="field-body">
                            <div class="field has-addons">
                                <div class="control">
                                {{ form.gridsquare(class_="input", placeholder_="Called Maidenhead Grid Square") }}
                                </div>
                                <div class="control">
                                    <a class="button is-info" id="maiden2latlon">&gt; Lat/Long</a>
                                </div>
                            </div>
                        {% if form.gridsquare.errors %}
                            <ul class="errors">
                                {% for error in form.gridsquare.errors %}
                                    <li>{{ error }}</li>
                                {% endfor %}
                            </ul>
                        {% endif %}
                        </div>
                    </div>
                    <div class="field is-horizontal">
                        <div class="field-label is-normal">
                            <label class="label" for="lat">Lat / Long</label>
                        </div>
                        <div class="field-body">
                            <div class="field">
                                <div class="control">
                                {{ form.lat(class_="input", placeholder_="Called station latitude") }}
                                </div>
                            </div>
                            {% if form.lat.errors %}
                            <ul class="errors">
                                {% for error in form.lat.errors %}
                                    <li>{{ error }}</li>
                                {% endfor %}
                            </ul>
                            {% endif %}
                            <div class="field">
                                <div class="control">
                                {{ form.lon(class_="input", placeholder_="Called station longitude") }}
                                </div>
                            </div>
                            {% if form.lon.errors %}
                            <ul class="errors">
                                {% for error in form.lon.errors %}
                                    <li>{{ error }}</li>
                                {% endfor %}
                            </ul>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
            <div class="card">
                <header class="card-header">
                    <p class="card-header-title is-info">SOTA / POTA / IOTA / WWFF</p>
                    <a class="card-header-icon" id="sota_pota" aria-label="more options">
                        <span class="icon">
                            <i class="fas fa-angle-down" aria-hidden="true"></i>
                        </span>
                    </a>
                </header>
                <div class="card-content is-hidden" id="sota_pota-content">
                    <div class="field is-horizontal">
                        <div class="field-label is-normal">
                            {{ form.my_sota_ref.label(class_="label") }}
                        </div>
                        <div class="field-body">
                            <div class="field has-addons">
                                <div class="control">
                                {{ form.my_sota_ref(class_="input", placeholder_="The logging station's International SOTA Reference.") }}
                                </div>
                                <div class="control">
                                    <a class="button is-info" id="my_sota">&gt; My Location</a>
                                </div>
                            </div>
                            {% if form.my_sota_ref.errors %}
                            <ul class="errors">
                                {% for error in form.my_sota_ref.errors %}
                                    <li>{{ error }}</li>
                                {% endfor %}
                            </ul>
                            {% endif %}
                            <fieldset disabled>
                                <div class="field">
                                    <div class="control is-expanded">
                                        <p class="control has-icons-left">
                                            <input class="input" id="mysummitname" placeholder="Summit Name">
                                            <span class="icon is-small is-left">
                                                <i class="fa-solid fa-mountain"></i>
                                            </span>
                                        </p>
                                    </div>
                                </div>
                            </fieldset>
                        </div>
                    </div>
                    <div class="field is-horizontal">
                        <div class="field-label is-normal">
                            {{ form.sota_ref.label(class_="label") }}
                        </div>
                        <div class="field-body">
                            <div class="field has-addons">
                                <div class="control">
                                {{ form.sota_ref(class_="input", placeholder_="The contacted station's International SOTA Reference.") }}
                                </div>
                                <div class="control">
                                    <a class="button is-info" id="sota">&gt; Station Location</a>
                                </div>
                            </div>
                            {% if form.sota_ref.errors %}
                            <ul class="errors">
                                {% for error in form.sota_ref.errors %}
                                    <li>{{ error }}</li>
                                {% endfor %}
                            </ul>
                            {% endif %}
                            <fieldset disabled>
                                <div class="field">
                                    <div class="control is-expanded">
                                        <p class="control has-icons-left">
                                            <input class="input" id="summitname" placeholder="Summit Name">
                                            <span class="icon is-small is-left">
                                                <i class="fa-solid fa-mountain"></i>
                                            </span>
                                        </p>
                                    </div>
                                </div>
                            </fieldset>
                        </div>
                    </div>
                    <div class="field is-horizontal">
                        <div class="field-label is-normal">
                            {{ form.my_pota_ref.label(class_="label") }}
                        </div>
                        <div class="field-body">
                            <div class="field has-addons">
                                <div class="control">
                                {{ form.my_pota_ref(class_="input", placeholder_="The logging station's International POTA Reference.") }}
                                </div>
                                <div class="control">
                                    <a class="button is-info" id="my_pota">&gt; My Location</a>
                                </div>
                            </div>
                            {% if form.my_pota_ref.errors %}
                            <ul class="errors">
                                {% for error in form.my_pota_ref.errors %}
                                    <li>{{ error }}</li>
                                {% endfor %}
                            </ul>
                            {% endif %}
                            <fieldset disabled>
                                <div class="field">
                                    <div class="control is-expanded">
                                        <p class="control has-icons-left">
                                            <input class="input" id="myparkname" placeholder="Park Name">
                                            <span class="icon is-small is-left">
                                                <i class="fa-solid fa-tree"></i>
                                            </span>
                                        </p>
                                    </div>
                                </div>
                            </fieldset>
                        </div>
                    </div>
                    <div class="field is-horizontal">
                        <div class="field-label is-normal">
                            {{ form.pota_ref.label(class_="label") }}
                        </div>
                        <div class="field-body">
                            <div class="field has-addons">
                                <div class="control">
                                {{ form.pota_ref(class_="input", placeholder_="The contacted station's International POTA Reference.") }}
                                </div>
                                <div class="control">
                                    <a class="button is-info" id="pota">&gt; Station Location</a>
                                </div>
                            </div>
                            {% if form.pota_ref.errors %}
                            <ul class="errors">
                                {% for error in form.pota_ref.errors %}
                                    <li>{{ error }}</li>
                                {% endfor %}
                            </ul>
                            {% endif %}
                            <fieldset disabled>
                                <div class="field">
                                    <div class="control is-expanded">
                                        <p class="control has-icons-left">
                                            <input class="input" id="parkname" placeholder="Park Name">
                                            <span class="icon is-small is-left">
                                                <i class="fa-solid fa-tree"></i>
                                            </span>
                                        </p>
                                    </div>
                                </div>
                            </fieldset>
                        </div>
                    </div>
                    <div class="field is-horizontal">
                        <div class="field-label is-normal">
                            {{ form.my_wwff_ref.label(class_="label") }}
                        </div>
                        <div class="field-body">
                            <div class="field">
                                <div class="control">
                                {{ form.my_wwff_ref(class_="input", placeholder_="e.g. GFF-0004") }}
                                </div>
                            </div>
                            {% if form.my_wwff_ref.errors %}
                            <ul class="errors">
                                {% for error in form.my_wwff_ref.errors %}
                                    <li>{{ error }}</li>
                                {% endfor %}
                            </ul>
                            {% endif %}
                        </div>
                    </div>
                    <div class="field is-horizontal">
                        <div class="field-label is-normal">
                            {{ form.wwff_ref.label(class_="label") }}
                        </div>
                        <div class="field-body">
                            <div class="field">
                                <div class="control">
                                {{ form.wwff_ref(class_="input", placeholder_="e.g. GFF-0004") }}
                                </div>
                            </div>
                            {% if form.wwff_ref.errors %}
                            <ul class="errors">
                                {% for error in form.wwff_ref.errors %}
                                    <li>{{ error }}</li>
                                {% endfor %}
                            </ul>
                            {% endif %}
                        </div>
                    </div>
                    <div class="field is-horizontal">
                        <div class="field-label is-normal">
                            {{ form.iota.label(class_="label") }}
                        </div>
                        <div class="field-body">
                            <div class="field">
                                <div class="control">
                                {{ form.iota(class_="input", placeholder_="e.g. EU-005") }}
                                </div>
                            </div>
                            {% if form.iota.errors %}
                            <ul class="errors">
                                {% for error in form.iota.errors %}
                                    <li>{{ error }}</li>
                                {% endfor %}
                            </ul>
                            {% endif %}
                        </div>
                    </div>
                    <div class="field is-horizontal">
                        <div class="field-label is-normal">
                            {{ form.my_iota.label(class_="label") }}
                        </div>
                        <div class="field-body">
                            <div class="field">
                                <div class="control">
                                {{ form.my_iota(class_="input", placeholder_="e.g. EU-005") }}
                                </div>
                            </div>
                            {% if form.my_iota.errors %}
                            <ul class="errors">
                                {% for error in form.my_iota.errors %}
                                    <li>{{ error }}</li>
                                {% endfor %}
                            </ul>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
            <div class="card">
                <header class="card-header">
                    <p class="card-header-title is-info">Sat and SIG</p>
                    <a class="card-header-icon" id="sat_sig" aria-label="more options">
                        <span class="icon">
                            <i class="fas fa-angle-down" aria-hidden="true"></i>
                        </span>
                    </a>
                </header>
                <div class="card-content is-hidden" id="sat_sig-content">
                    <nav class="level">
                        <div class="level-left">
                            <div class="level-item">
                                <div class="field">
                                    {{ form.sig.label(class_="label") }}
                                    <div class="field">
                                        <div class="control">
                                        {{ form.sig(class_="input", placeholder_="e.g. WAB or WAI") }}
                                        </div>
                                    </div>
                                    {% if form.sig.errors %}
                                    <ul class="errors">
                                        {% for error in form.sig.errors %}
                                            <li>{{ error }}</li>
                                        {% endfor %}
                                    </ul>
                                    {% endif %}
                                </div>
                            </div>
                            <div class="level-item">
                                <div class="field">
                                    {{ form.sig_info.label(class_="label") }}
                                    <div class="control">
                                    {{ form.sig_info(class_="input", placeholder_="e.g. ST46") }}
                                    </div>
                                    {% if form.sig_info.errors %}
                                    <ul class="errors">
                                        {% for error in form.sig_info.errors %}
                                            <li>{{ error }}</li>
                                        {% endfor %}
                                    </ul>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </nav>
                    <nav class="level">
                        <div class="level-left">
                            <div class="level-item">
                                <div class="field">
                                    {{ form.sat_name.label(class_="label") }}
                                    <div class="field">
                                        <div class="control">
                                        {{ form.sat_name(class_="input", placeholder_="e.g. SO-50") }}
                                        </div>
                                    </div>
                                    {% if form.sat_name.errors %}
                                    <ul class="errors">
                                        {% for error in form.sat_name.errors %}
                                            <li>{{ error }}</li>
                                        {% endfor %}
                                    </ul>
                                    {% endif %}
                                </div>
                            </div>
                            <div class="level-item">
                                <div class="field">
                                    {{ form.sat_mode.label(class_="label") }}
                                    <div class="control">
                                    {{ form.sat_mode(class_="input", placeholder_="e.g. V/U") }}
                                    </div>
                                    {% if form.sat_mode.errors %}
                                    <ul class="errors">
                                        {% for error in form.sat_mode.errors %}
                                            <li>{{ error }}</li>
                                        {% endfor %}
                                    </ul>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </nav>
                </div>
            </div>
            <div class="card">
                <header class="card-header">
                    <p class="card-header-title is-info">Comment</p>
                    <a class="card-header-icon" aria-label="more options">
                        <span class="icon">
                            <i class="fa-regular fa-comment"></i>
                        </span>
                    </a>
                </header>
                <div class="card-content" id="comment-content">
                    <nav class="level">
                        <div class="level-left">
                            <div class="level-item">
                                <div class="field">
                                    {{ form.comment.label(class_="label") }}
                                    <div class="control">
                                    {{ form.comment(class_="textarea") }}
                                    </div>
                                    <p class="help">Use this for notes about the QSO, particularly anything that couldn't be logged.</p>
                                </div>
                                {% if form.comment.errors %}
                                    <ul class="errors">
                                        {% for error in form.comment.errors %}
                                            <li>{{ error }}</li>
                                        {% endfor %}
                                    </ul>
                                {% endif %}
                            </div>
                        </div>
                    </nav>
                </div>
            </div>
            <div class="box">
                <nav class="level">
                    <div class="level-left">
                        <p class="level-item">Add a QSO to this callsign</p>
                        <input class="button is-link level-item" name="add_qso" type="submit" form="qsoform"></input>
                    </div>
                </nav>
            </div>
        </form>
    </div>
</section>

<script>
    $SCRIPT_ROOT = {{ request.script_root|tojson }};
</script>
<script>

$(document).ready(function() {

    $("#add_callsigns").click(function() {
    $("#add_callsigns-content").toggleClass('is-hidden');
    });

    $("#sota_pota").click(function() {
    $("#sota_pota-content").toggleClass('is-hidden');
    });

    $("#locations").click(function() {
    $("#locations-content").toggleClass('is-hidden');
    });

    $("#sat_sig").click(function() {
    $("#sat_sig-content").toggleClass('is-hidden');
    });

    $("#reports").click(function() {
    $("#reports-content").toggleClass('is-hidden');
    });

    $("#qsoon").click(function() {
    var today = new Date();
    var dd = today.getUTCDate();
    var mm = today.getUTCMonth()+1; //January is 0!
    var yyyy = today.getUTCFullYear();
    var hh = today.getUTCHours();
    var minutes = today.getUTCMinutes();

    if(dd<10){dd='0'+dd} 
    if(mm<10){mm='0'+mm}
    if(hh<10){hh='0'+hh}
    if(minutes<10){minutes='0'+minutes} 
    today = yyyy+'-'+mm+'-'+dd;
    todaytime = hh+':'+minutes;
    $("#qso_date").val(today),
    $("#time_on").val(todaytime);
    });

    $("#qsooff").click(function() {
    var today = new Date();
    var dd = today.getUTCDate();
    var mm = today.getUTCMonth()+1; //January is 0!
    var yyyy = today.getUTCFullYear();
    var hh = today.getUTCHours();
    var minutes = today.getUTCMinutes();

    if(dd<10){dd='0'+dd} 
    if(mm<10){mm='0'+mm}
    if(hh<10){hh='0'+hh}
    if(minutes<10){minutes='0'+minutes} 
    today = yyyy+'-'+mm+'-'+dd;
    todaytime = hh+':'+minutes;
    $("#qso_date_off").val(today),
    $("#time_off").val(todaytime);
    });

    $(function() {
        $('#lookupbutton').click(function() {
        $.getJSON($SCRIPT_ROOT + '/qsos/_dxcc', {
            callsign: $('input[name="call"]').val()
        }, function(data) {
            $("#country").val(data.country),
            $("#dxcc").val(data.get_adif_id),
            $("#ituz").val(data.ituz),
            $("#cqz").val(data.cqz);
        });
        return false;
        });
    });

    $(function() {
        $('#modes_bandsbutton').click(function() {
        $.getJSON($SCRIPT_ROOT + '/qsos/_freq', {
            freq: $('input[name="freq"]').val()
        }, function(data) {
            $("#band").val(data.bandmode);
        }).then(
            $.getJSON($SCRIPT_ROOT + '/qsos/_freq', {
            freq: $('input[name="freq_rx"]').val()
        }, function(data) {
            $("#band_rx").val(data.bandmode);
        })
        );
        return false;
        });
    });

    $(function() {
        $('#mymaiden2latlon').click(function() {
        $.getJSON($SCRIPT_ROOT + '/qsos/_maidenhead', {
            maidenhead: $('input[name="my_gridsquare"]').val()
        }, function(data) {
            $("#my_lat").val(data.latlong[0].toString().substring(0,11)),
            $("#my_lon").val(data.latlong[1].toString().substring(0,11));
        })
        return false;
        });
    });

    $(function() {
        $('#maiden2latlon').click(function() {
        $.getJSON($SCRIPT_ROOT + '/qsos/_maidenhead', {
            maidenhead: $('input[name="gridsquare"]').val()
        }, function(data) {
            $("#lat").val(data.latlong[0].toString().substring(0,11)),
            $("#lon").val(data.latlong[1].toString().substring(0,11));
        })
        return false;
        });
    });

    $(function() {
        $('#my_sota').click(function() {
            var $sotaapi = 'https://api2.sota.org.uk/api/summits/'+ $('input[name="my_sota_ref"]').val().split("/")[0]+ '/'+
            $('input[name="my_sota_ref"]').val().split("/")[1];
            $.getJSON($sotaapi,
                function(data) {
                $("#my_lat").val(data.latitude.toString().substring(0,11)),
                $("#my_lon").val(data.longitude.toString().substring(0,11)),
                $("#my_gridsquare").val(data.locator),
                $("#mysummitname").val(data.name);
            });
        return false;
        });
    });

    $(function() {
        $('#sota').click(function() {
            var $sotaapi2 = 'https://api2.sota.org.uk/api/summits/'+ $('input[name="sota_ref"]').val().split("/")[0]+ '/'+
            $('input[name="sota_ref"]').val().split("/")[1];
            $.getJSON($sotaapi2,
                function(data) {
                $("#lat").val(data.latitude.toString().substring(0,11)),
                $("#lon").val(data.longitude.toString().substring(0,11)),
                $("#gridsquare").val(data.locator),
                $("#summitname").val(data.name);
            });
        return false;
        });
    });

    $(function() {
        $('#my_pota').click(function() {
            var $potaapi = 'https://api.pota.app/park/'+ $('input[name="my_pota_ref"]').val();
            $.getJSON($potaapi,
                function(data) {
                $("#my_lat").val(data.latitude.toString().substring(0,11)),
                $("#my_lon").val(data.longitude.toString().substring(0,11)),
                $("#my_gridsquare").val(data.grid6),
                $("#myparkname").val(data.name);
            });
        return false;
        });
    });

    $(function() {
        $('#pota').click(function() {
            var $potaapi2 = 'https://api.pota.app/park/'+ $('input[name="pota_ref"]').val();
            $.getJSON($potaapi2,
                function(data) {
                $("#lat").val(data.latitude.toString().substring(0,11)),
                $("#lon").val(data.longitude.toString().substring(0,11)),
                $("#gridsquare").val(data.grid6),
                $("#parkname").val(data.name);
            });
        return false;
        });
    });

    setTimeout(function(){
        $(".notification").fadeOut("slow");
    }, 5000);

});
    var diction = {
        AM: [],
        ATV: [],
        CW: ["", "PCW"],
        DIGITALVOICE: ["", "C4FM", "DMR", "DSTAR", "FREEDV", "M17"],
        FM: [],
        FT8: [],
        HELL: ["", "FMHELL", "FSKHELL", "HELL80", "HELLX5", "HELLX9", "HFSK", "PSKHELL", "SLOWHELL"],
        MFSK: ["", "FSQCALL", "FST4", "FST4W", "FT4", "JS8", "JTMS", "MFSK4", "MFSK8", "MFSK11", "MFSK16", "MFSK22", "MFSK31", "MFSK32", "MFSK64", "MFSK64L", "MFSK128", "MFSK128L", "Q65"],
        OLIVIA: ["", "OLIVIA 4/125", "OLIVIA 4/250", "OLIVIA 8/250", "OLIVIA 8/500", "OLIVIA 16/500", "OLIVIA 16/1000", "OLIVIA 32/1000"],
        PKT: [], 	 
        PSK: ["", "8PSK125", "8PSK125F", "8PSK125FL", "8PSK250", "8PSK250F", "8PSK250FL", "8PSK500", "8PSK500F", "8PSK1000", "8PSK1000F", "8PSK1200F", "FSK31", "PSK10", "PSK31", "PSK63", "PSK63F", "PSK63RC4", "PSK63RC5", "PSK63RC10", "PSK63RC20", "PSK63RC32", "PSK125", "PSK125C12", "PSK125R", "PSK125RC10", "PSK125RC12", "PSK125RC16", "PSK125RC4", "PSK125RC5", "PSK250", "PSK250C6", "PSK250R", "PSK250RC2", "PSK250RC3", "PSK250RC5", "PSK250RC6", "PSK250RC7", "PSK500", "PSK500C2", "PSK500C4", "PSK500R", "PSK500RC2", "PSK500RC3", "PSK500RC4", "PSK800C2", "PSK800RC2", "PSK1000", "PSK1000C2", "PSK1000R", "PSK1000RC2", "PSKAM10", "PSKAM31", "PSKAM50", "PSKFEC31", "QPSK31", "QPSK63", "QPSK125", "QPSK250", "QPSK500", "SIM31"],
        RTTY: ["", "ASCI"],	 
        RTTYM: [],	 	 
        SSB: ["", "LSB", "USB"],	 
        SSTV: [],
        ARDOP: [],
        CHIP: ["", "CHIP64", "CHIP128"],
        CLO: [],
        CONTESTI: [],
        DOMINO: ["", "DOM-M", "DOM4", "DOM5", "DOM8", "DOM11", "DOM16", "DOM22", "DOM44", "DOM88", "DOMINOEX", "DOMINOF"],
        DYNAMIC: ["", "VARA HF", "VARA SATELLITE", "VARA FM 1200", "VARA FM 9600"],
        FAX: [],
        FSK441: [],
        ISCAT: ["", "ISCAT-A", "ISCAT-B"],
        JT4: ["", "JT4A", "JT4B", "JT4C", "JT4D", "JT4E", "JT4F", "JT4G"],
        JT6M: [],
        JT9: ["", "JT9-1", "JT9-2", "JT9-5", "JT9-10", "JT9-30", "JT9A", "JT9B", "JT9C", "JT9D", "JT9E", "JT9E FAST", "JT9F", "JT9F FAST", "JT9G", "JT9G FAST", "JT9H", "JT9H FAST"],
        JT44: [],
        JT65: ["", "JT65A", "JT65B", "JT65B2", "JT65C", "JT65C2"],
        MSK144: [],
        MT63: [],
        OPERA: ["", "OPERA-BEACON", "OPERA-QSO"],
        PAC: ["", "PAC2", "PAC3", "PAC4"],
        PAX: ["", "PAX2"],
        PSK2K: [],
        Q15: [],
        QRA64: ["", "QRA64A", "QRA64B", "QRA64C", "QRA64D", "QRA64E"],	 
        ROS: ["", "ROS-EME", "ROS-HF", "ROS-MF"],
        T10: [],
        THOR: ["", "THOR-M", "THOR4", "THOR5", "THOR8", "THOR11", "THOR16", "THOR22", "THOR25X4", "THOR50X1", "THOR50X2", "THOR100"],
        THRB: ["", "THRBX", "THRBX1", "THRBX2", "THRBX4", "THROB1", "THROB2", "THROB4"],
        TOR: ["", "AMTORFEC", "GTOR", "NAVTEX", "SITORB"],
        V4: [],
        VOI: [],
        WINMOR: [],
        WSPR: []	
    }
    $('#mode').on('change', function() {
    $('#submode').html(
        diction[$(this).val()].reduce(function(p, c) {
        return p.concat('<option value="' + c + '">' + c + '</option>');
        }, '')
    );
    }).trigger('blur');

</script>
{% endblock %}
